<?php
/**
 * LocalCatalyst Child Theme Functions
 *
 * @package LocalCatalyst
 */

// Prevent direct access
if (!defined('ABSPATH')) exit;

/**
 * Load schema markup functions
 */
require_once get_stylesheet_directory() . '/includes/schema-markup.php';

/**
 * Hide default GP header, navigation, and footer
 * We use our own custom nav and footer via hooks below
 */
add_action('after_setup_theme', function () {
    remove_action('generate_header', 'generate_construct_header');
    remove_action('generate_footer', 'generate_construct_footer');
}, 20);

// Hide GP site info bar
add_filter('generate_footer_widgets', '__return_zero');
add_filter('generate_show_footer', '__return_false');
add_filter('generate_copyright', '__return_empty_string');

/**
 * Enqueue parent + child styles, Google Fonts
 */
add_action('wp_enqueue_scripts', function () {
    // Parent theme
    wp_enqueue_style('generatepress', get_template_directory_uri() . '/style.css');

    // Child theme
    wp_enqueue_style('localcatalyst', get_stylesheet_uri(), ['generatepress'], '1.0.0');

    // Global component styles
    wp_enqueue_style(
        'localcatalyst-global',
        get_stylesheet_directory_uri() . '/css/localcatalyst_global-styles.css',
        ['localcatalyst'],
        '1.0.1'
    );

    // Google Fonts
    wp_enqueue_style(
        'localcatalyst-fonts',
        'https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700&family=Space+Mono:wght@400;700&display=swap',
        [],
        null
    );
});

/**
 * Inline scroll animation observer
 * Adds .is-visible class to elements with .lc-fade-in when they enter viewport
 */
add_action('wp_footer', function () {
    ?>
    <script>
    (function() {
        const observer = new IntersectionObserver(
            (entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                    }
                });
            },
            { threshold: 0.12 }
        );

        document.querySelectorAll('.lc-fade-in').forEach(el => observer.observe(el));

        // Re-observe after any AJAX content loads (WooCommerce, etc.)
        const mutationObserver = new MutationObserver(() => {
            document.querySelectorAll('.lc-fade-in:not(.is-visible)').forEach(el => observer.observe(el));
        });
        mutationObserver.observe(document.body, { childList: true, subtree: true });
    })();
    </script>
    <?php
});

/**
 * Inline nav scroll behavior
 * Adds .scrolled class to .lc-nav after 80px scroll
 */
add_action('wp_footer', function () {
    ?>
    <script>
    (function() {
        const nav = document.querySelector('.lc-nav');
        if (!nav) return;
        let ticking = false;
        window.addEventListener('scroll', function() {
            if (!ticking) {
              