$max_agents,
                'max_tasks_monthly' => $max_tasks,
            ],
            'current_period_end' => $sub->get_date('next_payment'),
        ];
    }

    return new WP_REST_Response([
        'count' => count($results),
        'subscriptions' => $results,
    ], 200);
}

/**
 * POST /openclaw/v1/fleet/health
 * Receives fleet health status and stores it as a transient for the customer dashboard.
 */
function openclaw_receive_fleet_health(WP_REST_Request $request): WP_REST_Response {
    $data = $request->get_json_params();

    // Store as WordPress transient (expires after 10 minutes)
    set_transient('openclaw_fleet_health', [
        'received_at' => current_time('mysql'),
        'agents_active' => $data['agents_active'] ?? 0,
        'agents_total' => $data['agents_total'] ?? 0,
        'tasks_pending' => $data['tasks_pending'] ?? 0,
        'fleet_cost_today' => $data['fleet_cost_today'] ?? 0,
        'breakers_tripped' => $data['breakers_tripped'] ?? [],
    ], 600);

    return new WP_REST_Response(['ok' => true], 200);
}

// ─── ORDER FULFILLMENT ENDPOINTS ─────────────────────────────────────

add_action('rest_api_init', function () {

    // POST /openclaw/v1/orders/fulfill
    // Called by fleet/dispatcher when an order deliverable is ready.
    // Marks WC order as completed and stores deliverable URL.
    register_rest_route(OPENCLAW_BRIDGE_NAMESPACE, '/orders/fulfill', [
        'methods' => 'POST',
        'callback' => 'openclaw_fulfill_order',
        'permission_callback' => 'openclaw_hmac_permission',
    ]);

});

/**
 * POST /openclaw/v1/orders/fulfill
 * Marks a WooCommerce order as completed and attaches deliverable metadata.
 */
function openclaw_fulfill_order(WP_REST_Request $request): WP_REST_Response {
    $data = $request->get_json_params();

    $wc_order_id = $data['wcOrderId'] ?? null;
    $deliverable_url = $data['deliverableUrl'] ?? null;

    if (!$wc_order_id) {
        return new WP_REST_Response(['error' => 'Missing wcOrderId'], 400);
    }

    $order = wc_get_order($wc_order_id);
    if (!$order) {
        return new WP_REST_Response(['error' => 'WC order not found'], 404);
    }

    // Store deliverable URL as order meta
    if ($deliverable_url) {
        $order->update_meta_data('_openclaw_deliverable_url', sanitize_url($deliverable_url));
    }

    // Add order note
    $order->add_order_note(
        sprintf(
            'OpenClaw order fulfilled.%s',
            $deliverable_url ? " Deliverable: {$deliverable_url}" : ''
        )
    );

    // Mark as completed
    $order->set_status('completed', 'Fulfilled by OpenClaw fleet.');
    $order->save();

    return new WP_REST_Response(['ok' => true, 'wcOrderId' => $wc_order_id], 200);
}

// ─── WC PAYMENT COMPLETE → CONVEX WEBHOOK ────────────────────────────
// When a customer pays for an order, notify Convex to create the order
// record and generate an access token for the intake form.

// Convex site URL — set in wp-config.php OR as WordPress options:
// define('OPENCLAW_CONVEX_SITE_URL', 'https://valuable-partridge-851.convex.site');
// define('OPENCLAW_CONVEX_API_TOKEN', 'your-convex-api-token');
// Fallback: get_option('openclaw_convex_site_url') / get_option('openclaw_convex_api_token')

add_action('woocommerce_payment_complete', function ($order_id) {
    $convex_url = defined('OPENCLAW_CONVEX_SITE_URL') ? OPENCLAW_CONVEX_SITE_URL : get_option('openclaw_convex_site_url');
    $convex_token = defined('OPENCLAW_CONVEX_API_TOKEN') ? OPENCLAW_CONVEX_API_TOKEN : get_option('openclaw_convex_api_token');

    if (!$convex_url