aW9uIChXUF9SRVNUX1JlcXVlc3QgJHJlcXVlc3QpIHsKICAgICAgICAgICAgJGRhdGEgPSAkcmVxdWVzdC0+Z2V0X2pzb25fcGFyYW1zKCk7CiAgICAgICAgICAgICRhbGxvd2VkX2tleXMgPSBbCiAgICAgICAgICAgICAgICAnb3BlbmNsYXdfY29udmV4X3NpdGVfdXJsJywKICAgICAgICAgICAgICAgICdvcGVuY2xhd19jb252ZXhfYXBpX3Rva2VuJywKICAgICAgICAgICAgICAgICdvcGVuY2xhd19kYXNoYm9hcmRfdXJsJywKICAgICAgICAgICAgXTsKICAgICAgICAgICAgJHVwZGF0ZWQgPSBbXTsKICAgICAgICAgICAgZm9yZWFjaCAoJGFsbG93ZWRfa2V5cyBhcyAka2V5KSB7CiAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJGRhdGFbJGtleV0pKSB7CiAgICAgICAgICAgICAgICAgICAgdXBkYXRlX29wdGlvbigka2V5LCBzYW5pdGl6ZV90ZXh0X2ZpZWxkKCRkYXRhWyRrZXldKSwgZmFsc2UpOwogICAgICAgICAgICAgICAgICAgICR1cGRhdGVkW10gPSAka2V5OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBuZXcgV1BfUkVTVF9SZXNwb25zZShbCiAgICAgICAgICAgICAgICAnb2snID0+IHRydWUsCiAgICAgICAgICAgICAgICAndXBkYXRlZCcgPT4gJHVwZGF0ZWQsCiAgICAgICAgICAgIF0sIDIwMCk7CiAgICAgICAgfSwKICAgICAgICAncGVybWlzc2lvbl9jYWxsYmFjaycgPT4gJ29wZW5jbGF3X2htYWNfcGVybWlzc2lvbicsCiAgICBdKTsKCiAgICAvLyBHRVQgL29wZW5jbGF3L3YxL2JyaWRnZS9jb25maWcKICAgIC8vIFJlYWQgY3VycmVudCBPcGVuQ2xhdyBjb25maWd1cmF0aW9uIChITUFDLWF1dGhlbnRpY2F0ZWQpLgogICAgcmVnaXN0ZXJfcmVzdF9yb3V0ZShPUEVOQ0xBV19CUklER0VfTkFNRVNQQUNFLCAnL2JyaWRnZS9jb25maWcnLCBbCiAgICAgICAgJ21ldGhvZHMnID0+ICdHRVQnLAogICAgICAgICdjYWxsYmFjaycgPT4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IFdQX1JFU1RfUmVzcG9uc2UoWwogICAgICAgICAgICAgICAgJ29wZW5jbGF3X2NvbnZleF9zaXRlX3VybCcgPT4gZ2V0X29wdGlvbignb3BlbmNsYXdfY29udmV4X3NpdGVfdXJsJywgJycpLAogICAgICAgICAgICAgICAgJ29wZW5jbGF3X2NvbnZleF9hcGlfdG9rZW4nID0+IGdldF9vcHRpb24oJ29wZW5jbGF3X2NvbnZleF9hcGlfdG9rZW4nKSA/ICcqKipTRVQqKionIDogJycsCiAgICAgICAgICAgICAgICAnb3BlbmNsYXdfZGFzaGJvYXJkX3VybCcgPT4gZ2V0X29wdGlvbignb3BlbmNsYXdfZGFzaGJvYXJkX3VybCcsICcnKSwKICAgICAgICAgICAgXSwgMjAwKTsKICAgICAgICB9LAogICAgICAgICdwZXJtaXNzaW9uX2NhbGxiYWNrJyA9PiAnb3BlbmNsYXdfaG1hY19wZXJtaXNzaW9uJywKICAgIF0pOwp9KTsKCi8vIOKUgOKUgOKUgCBFTkRQT0lOVCBIQU5ETEVSUyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDi